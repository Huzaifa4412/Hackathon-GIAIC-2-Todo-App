# Implementation Plan: Better Auth Implementation with Google OAuth & Neon PostgreSQL

**Branch**: `001-better-auth-oauth` | **Date**: 2025-01-13 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-better-auth-oauth/spec.md`

## Summary

This feature implements a comprehensive authentication system for a Next.js 16+ web application using Better Auth, a modern authentication library that provides both email/password authentication and Google OAuth 2.0 integration.

**Primary Requirements**:
- Email/password sign-up and sign-in with secure password hashing (scrypt)
- Google OAuth 2.0 sign-in with account linking
- Session management with cookie-based authentication (7-day rolling expiration)
- User profile management with email verification support
- Password reset functionality via email tokens

**Technical Approach**:
- **Backend**: Better Auth server integrated with Next.js API routes
- **Database**: Neon PostgreSQL with 4 core tables (user, session, account, verification)
- **Security**: scrypt password hashing, CSRF protection, rate limiting, secure cookies
- **Frontend**: React Server Components + Client Components with Better Auth client hooks
- **Deployment**: Vercel for frontend, Neon serverless PostgreSQL for database

## Technical Context

**Language/Version**: TypeScript 5.0+, Next.js 16.1.1, React 19.2.3
**Primary Dependencies**:
- better-auth@1.4.10 (authentication framework)
- @neondatabase/serverless (PostgreSQL driver for Neon)
- next@16.1.1 (React framework with App Router)
- react@19.2.3 (UI library)
- tailwindcss@4 (styling)

**Storage**: Neon PostgreSQL (serverless) with connection pooling
**Testing**: Vitest (unit), Playwright (E2E), Better Auth test utilities
**Target Platform**: Vercel (production), localhost (development)
**Project Type**: Web application (full-stack with API routes)
**Performance Goals**:
- Authentication endpoints: <500ms p95 response time
- Google OAuth callback: <2s completion time
- Session validation: <100ms from cookie
- Support 100 concurrent sign-in requests

**Constraints**:
- scrypt password hashing algorithm (memory-hard, CPU-intensive)
- 7-day rolling session expiration with 1-day refresh threshold
- 60 requests per minute rate limit per IP address
- httpOnly, secure, sameSite cookies for session tokens
- OAuth tokens encrypted at rest (if enabled)
- Zero-downtime database migrations using Neon branches

**Scale/Scope**:
- Initial deployment: 1,000-10,000 users
- Database: Neon serverless (auto-scaling)
- Session storage: PostgreSQL with cookie cache (5-minute TTL)
- Account linking: Users can have both email/password and Google OAuth accounts

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### SDD Principles
- ✅ **spec.md exists before implementation**: [spec.md](./spec.md) completed with 4 user stories, 62 functional requirements, 10 success criteria
- ✅ **plan.md exists before code**: This file documents architecture and implementation approach
- ✅ **tasks.md before implementation**: Will be generated by `/sp.tasks` command next
- ✅ **Constitution compliance**: All checks below pass

### Architecture Principles
- ✅ **Three-tier architecture**: Frontend (Next.js) → API (Better Auth) → Database (Neon PostgreSQL)
- ✅ **JWT-based authentication**: Session tokens in httpOnly cookies, 7-day expiration
- ✅ **Database standards**: Neon PostgreSQL with proper indexes, foreign keys, CASCADE delete
- ✅ **API-first design**: RESTful endpoints defined in [contracts/api-openapi.yaml](./contracts/api-openapi.yaml)

### Authentication & Security Standards
- ✅ **Better Auth requirement**: Using better-auth@1.4.10 as specified in constitution
- ✅ **JWT with 7-day expiry**: Configured in Better Auth session settings
- ✅ **scrypt password hashing**: Default Better Auth algorithm (memory-hard, resistant to brute-force)
- ✅ **CSRF protection**: Origin validation, state parameters for OAuth, secure cookies
- ✅ **Rate limiting**: 60 req/min per IP using in-memory storage
- ✅ **Security headers**: CSP, X-Frame-Options, X-Content-Type-Options configured

### Database Standards
- ✅ **Neon PostgreSQL**: Using Neon serverless for zero-downtime migrations
- ✅ **Proper indexes**: Indexes on email, session token, user_id for performance
- ✅ **Foreign key constraints**: CASCADE delete on user→sessions, user→accounts
- ✅ **Migration strategy**: Using Better Auth CLI with Neon branches

### Frontend Standards
- ✅ **Next.js 16+ with App Router**: Using latest Next.js with Server Components
- ✅ **Server Components for data fetching**: Session validation uses auth.api.getSession() in RSC
- ✅ **Client Components for interactivity**: Sign-in/sign-up forms use "use client"
- ✅ **TypeScript**: Full type safety with Better Auth TypeScript inference

### Testing Standards
- ✅ **80% backend coverage**: Will implement unit tests for all auth endpoints
- ✅ **70% frontend coverage**: Will implement component tests for auth UI
- ✅ **E2E tests**: Playwright tests for critical authentication flows
- ✅ **No [NEEDS CLARIFICATION]**: All testable requirements identified

**Status**: ✅ **ALL GATES PASSED** - Proceed to implementation

## Project Structure

### Documentation (this feature)

```text
specs/001-better-auth-oauth/
├── spec.md              # Feature requirements (4 user stories, 62 FRs, 10 SC)
├── plan.md              # This file (architecture decisions, implementation phases)
├── research.md          # Better Auth research findings (650+ lines)
├── data-model.md        # Database schema (user, session, account, verification)
├── quickstart.md        # Developer setup guide
├── contracts/           # API specifications
│   └── api-openapi.yaml # OpenAPI 3.0.3 spec for all auth endpoints
├── checklists/          # Quality validation
│   └── requirements.md  # Spec quality checklist (all ✅ passed)
└── tasks.md             # Implementation tasks (to be created by /sp.tasks)
```

### Source Code (repository root)

This feature integrates into the existing Next.js application structure:

```text
# Web application (frontend + API routes in Next.js)
frontend/                           # Next.js 16+ application
├── src/
│   ├── app/
│   │   ├── api/auth/
│   │   │   └── [...all]/           # Better Auth API route handler
│   │   │       └── route.ts        # toNextJsHandler(auth.handler)
│   │   ├── (auth)/                 # Auth route group (no URL prefix)
│   │   │   ├── sign-in/
│   │   │   │   └── page.tsx        # Email + Google OAuth sign-in
│   │   │   └── sign-up/
│   │   │       └── page.tsx        # Email/password sign-up
│   │   ├── (dashboard)/            # Protected route group
│   │   │   ├── page.tsx            # Dashboard (session-protected)
│   │   │   └── profile/
│   │   │       └── page.tsx        # User profile management
│   │   ├── layout.tsx              # Root layout with providers
│   │   └── page.tsx                # Root redirects to sign-in/dashboard
│   ├── components/
│   │   ├── auth/
│   │   │   ├── sign-in-form.tsx    # Email/password sign-in form
│   │   │   ├── sign-up-form.tsx    # Email/password sign-up form
│   │   │   └── oauth-button.tsx    # "Sign in with Google" button
│   │   └── session/
│   │       └── session-provider.tsx # Client-side session state
│   └── lib/
│       ├── auth.ts                 # Better Auth server configuration
│       ├── auth-client.ts          # Better Auth React client
│       └── db.ts                   # Neon database connection
└── tests/
    ├── unit/
    │   └── auth.test.ts            # Unit tests for auth utilities
    └── e2e/
        └── auth.spec.ts            # Playwright E2E tests
```

**Structure Decision**: This is a **web application** (Option 2) using Next.js 16+ with:
- **API routes integrated** in `app/api/auth/` (Better Auth handlers)
- **Server Components** for data fetching (session validation)
- **Client Components** for interactivity (forms, OAuth buttons)
- **Route groups** `(auth)` and `(dashboard)` for URL-agnostic organization

**No separate backend directory** - Better Auth is integrated directly into Next.js API routes, following Next.js 16+ best practices for serverless deployment on Vercel.

## Complexity Tracking

> **No complexity tracking needed** - all Constitution Check gates passed ✅

## Architecture Decisions

### Decision 1: Better Auth vs. Auth0/Clerk/NextAuth

**Choice**: Better Auth

**Rationale**:
- **TypeScript-first**: Full type inference for session data, user objects, and API responses
- **Next.js 16+ native**: Built for App Router with Server Components and Server Actions
- **Lightweight**: No external service dependency, self-hosted authentication
- **Database control**: Full access to user data in Neon PostgreSQL
- **OAuth flexibility**: Easy to add multiple providers (Google, GitHub, Apple)
- **Cost-effective**: No per-user pricing, unlike Auth0/Clerk

**Trade-offs**:
- **More setup required**: Need to configure database schema, OAuth providers manually
- **No built-in UI**: Must create own sign-in/sign-up components (but have full control)
- **Self-hosted**: Responsible for security, updates, monitoring

**Alternatives Considered**:
- **Clerk**: Excellent DX but expensive at scale, limited database control
- **Auth0**: Enterprise-grade but complex setup, high cost
- **NextAuth v4**: Older library, less TypeScript support, being replaced by Auth.js

### Decision 2: Neon PostgreSQL vs. Supabase/PlanetScale

**Choice**: Neon PostgreSQL (serverless)

**Rationale**:
- **Branch-based development**: Create database branches for testing migrations
- **Zero-downtime migrations**: Safely deploy schema changes without downtime
- **Serverless auto-scaling**: Pay only for actual usage, no connection pooling complexity
- **PostgreSQL 16**: Latest stable PostgreSQL with all features
- **Vercel integration**: Native Vercel deployment support
- **Better Auth compatibility**: Official Better Auth PostgreSQL adapter

**Trade-offs**:
- **Cold starts**: Serverless cold starts (~100ms) vs. dedicated connection pool
- **Limited storage**: 3GB free tier, 500MB total database size
- **Regional availability**: Fewer regions than AWS RDS

**Alternatives Considered**:
- **Supabase**: More features (realtime, storage) but heavier, opinionated
- **PlanetScale**: MySQL-only, Better Auth has better PostgreSQL support
- **AWS RDS**: More control but higher cost, no branching

### Decision 3: Cookie-Based Sessions vs. JWT-only

**Choice**: Cookie-based sessions with JWT plugin for external services

**Rationale**:
- **Better Auth default**: Cookie-based sessions are the recommended approach
- **Security**: httpOnly cookies prevent XSS attacks on session tokens
- **CSRF protection**: Built-in CSRF protection with origin validation
- **Simple implementation**: No manual JWT refresh logic required
- **7-day rolling expiration**: Automatic session extension on activity

**JWT Plugin** (`better-auth/plugins/jwt`):
- For external API authentication (e.g., FastAPI backend)
- JWKS endpoint at `/api/auth/jwks` for token verification
- Token endpoint at `/api/auth/token` for JWT generation
- Ed25519 signature algorithm (fast, secure)

**Trade-offs**:
- **Cookie dependency**: Requires cookies enabled (works for 99.9% of users)
- **Mobile apps**: Need separate JWT authentication for native apps
- **Microservices**: Must use JWT plugin for service-to-service auth

**Alternatives Considered**:
- **JWT-only**: More flexible but requires manual refresh logic, less secure (XSS risk)
- **Session IDs**: Requires server-side session storage, less scalable

### Decision 4: Account Linking by Email

**Choice**: Enable automatic account linking when email matches

**Rationale**:
- **User experience**: Users can sign up with email, then later add Google OAuth (or vice versa)
- **Single user record**: One `user` row with multiple linked `account` rows
- **Better Auth default**: Automatic linking when `account.accountLinking.enabled: true`
- **Prevents duplicate accounts**: User won't accidentally create two accounts with same email

**Implementation**:
```typescript
account: {
  accountLinking: {
    enabled: true,
    trustedProviders: ["google", "email-password"],
    allowDifferentEmails: false  // Only link if emails match
  }
}
```

**Trade-offs**:
- **Security assumption**: Trusting Google's email verification (email can be spoofed in OAuth flow)
- **Conflicts**: If two providers have different emails for same user, no linking

**Alternatives Considered**:
- **No linking**: Simpler but users have multiple accounts, confusing UX
- **Manual linking**: Users manually link accounts in settings (more control but more friction)

### Decision 5: Scrypt Password Hashing

**Choice**: Use Better Auth's default scrypt algorithm

**Rationale**:
- **Memory-hard**: Resistant to GPU/ASIC brute-force attacks
- **Better Auth default**: No additional configuration required
- **Secure**: NIST-recommended algorithm ( finalist in Password Hashing Competition)
- **Slow**: intentionally slow to prevent brute-force (configurable cost factor)

**Trade-offs**:
- **CPU-intensive**: Slower than bcrypt (but more secure)
- **Not reversible**: Cannot decrypt passwords (by design, security feature)

**Alternatives Considered**:
- **bcrypt**: Faster but less memory-hard, more vulnerable to GPU attacks
- **argon2**: Newer, even more secure but less battle-tested than scrypt
- **PBKDF2**: NIST-approved but weaker than scrypt/argon2

## Implementation Phases

### Phase 0: Research & Discovery ✅

**Status**: Complete

**Deliverables**:
- [research.md](./research.md) - Better Auth research findings (650+ lines)

**Key Findings**:
- Better Auth 1.4+ supports Next.js 16+ App Router with Server Components
- Neon PostgreSQL requires specific connection string format for serverless driver
- Google OAuth requires redirect URI configuration in Google Cloud Console
- Session management uses httpOnly cookies with 7-day rolling expiration
- Account linking is automatic when emails match

### Phase 1: Design Artifacts ✅

**Status**: Complete

**Deliverables**:
- [data-model.md](./data-model.md) - Database schema with 4 entities (user, session, account, verification)
- [contracts/api-openapi.yaml](./contracts/api-openapi.yaml) - OpenAPI 3.0.3 specification
- [quickstart.md](./quickstart.md) - Developer setup guide (750+ lines)

**Key Design Decisions**:
- 4 database tables: `user`, `session`, `account`, `verification`
- Email/password accounts stored in `account` table with `providerId = "email-password"`
- Google OAuth accounts stored in `account` table with `providerId = "google"`
- Account linking: One `user` can have multiple `account` rows (email + Google)
- Foreign key constraints with CASCADE delete for data integrity

### Phase 2: Development Environment Setup

**Status**: Pending (next phase after `/sp.tasks`)

**Tasks**:
1. Install Better Auth dependencies
2. Configure environment variables (`.env.local`)
3. Create Neon PostgreSQL database
4. Set up Google OAuth credentials
5. Generate database schema using Better Auth CLI
6. Run database migrations

**Deliverables**:
- Working development environment
- Database tables created in Neon
- Better Auth configured in Next.js
- Google OAuth app created

### Phase 3: Core Authentication Implementation

**Status**: Pending

**Tasks**:
1. Create Better Auth server configuration (`lib/auth.ts`)
2. Create API route handler (`app/api/auth/[...all]/route.ts`)
3. Create auth client (`lib/auth-client.ts`)
4. Implement email/password sign-up
5. Implement email/password sign-in
6. Implement Google OAuth flow
7. Implement session management
8. Implement sign-out functionality

**Deliverables**:
- Working email/password authentication
- Working Google OAuth authentication
- Session management with cookies
- Protected API endpoints

### Phase 4: UI Components & Pages

**Status**: Pending

**Tasks**:
1. Create sign-in page (`app/(auth)/sign-in/page.tsx`)
2. Create sign-up page (`app/(auth)/sign-up/page.tsx`)
3. Create dashboard page (`app/(dashboard)/page.tsx`)
4. Create profile management page (`app/(dashboard)/profile/page.tsx`)
5. Create auth UI components (forms, buttons, inputs)
6. Add error handling and validation
7. Add loading states and animations

**Deliverables**:
- Fully functional authentication UI
- User profile management
- Responsive design for mobile/tablet

### Phase 5: Testing & Quality Assurance

**Status**: Pending

**Tasks**:
1. Write unit tests for auth utilities (Vitest)
2. Write integration tests for API endpoints
3. Write E2E tests for authentication flows (Playwright)
4. Test account linking scenarios
5. Test session expiration and refresh
6. Test error handling (invalid credentials, OAuth failures)
7. Test rate limiting
8. Performance testing (load testing)
9. Security audit (OWASP Top 10)

**Deliverables**:
- 80%+ backend code coverage
- 70%+ frontend code coverage
- All E2E test scenarios passing
- Performance benchmarks met
- Security audit passed

### Phase 6: Deployment & Documentation

**Status**: Pending

**Tasks**:
1. Configure production environment variables
2. Set up Vercel deployment
3. Configure production Neon database
4. Set up Google OAuth production credentials
5. Run database migrations in production
6. Test production deployment
7. Set up monitoring and error tracking (Sentry)
8. Write deployment documentation
9. Create runbook for common issues

**Deliverables**:
- Production deployment on Vercel
- Production Neon database
- Monitoring and error tracking configured
- Complete documentation

## Risk Assessment

| Risk | Probability | Impact | Mitigation |
|------|------------|--------|-----------|
| **Google OAuth service downtime** | Low | High | Provide email/password fallback, implement retry logic |
| **Neon database connection issues** | Medium | High | Implement connection pooling, retry logic, circuit breaker |
| **Session cookie theft via XSS** | Low | Critical | Implement CSP headers, httpOnly cookies, input sanitization |
| **Brute-force password attacks** | Medium | Medium | Rate limiting (60 req/min), scrypt hashing, account lockout |
| **CSRF attacks on OAuth flow** | Low | High | State parameter validation, PKCE, origin checking |
| **Database migration failures** | Low | Critical | Use Neon branches for testing, rollback plan, backup strategy |
| **Session fixation attacks** | Low | Critical | Regenerate session ID after authentication, secure cookies |
| **OAuth token leakage in logs** | Medium | Medium | Never log tokens, encrypt at rest, audit logging statements |
| **Performance degradation under load** | Medium | Medium | Load testing, database indexes, cookie cache (5-min TTL) |
| **User data breach** | Low | Critical | Encrypt OAuth tokens, security audit, penetration testing |

## Dependencies & External Services

### Required Services

1. **Neon PostgreSQL** (https://neon.tech)
   - Purpose: User data storage, session management
   - Cost: Free tier (500MB database, 3GB storage)
   - SLA: 99.95% uptime
   - Region: us-east-1 (or closest to users)

2. **Google Cloud Console** (https://console.cloud.google.com)
   - Purpose: OAuth 2.0 credentials
   - Cost: Free
   - Required APIs: Google+ API (or People API)

### Required Dependencies

```json
{
  "dependencies": {
    "better-auth": "^1.4.10",
    "@neondatabase/serverless": "^0.9.0",
    "next": "^16.1.1",
    "react": "^19.2.3",
    "tailwindcss": "^4.0.0"
  },
  "devDependencies": {
    "@types/node": "^20.0.0",
    "typescript": "^5.0.0",
    "vitest": "^2.0.0",
    "playwright": "^1.40.0"
  }
}
```

### Environment Variables

```bash
# Required
BETTER_AUTH_SECRET=<min-32-characters>
DATABASE_URL=<neon-connection-string>
GOOGLE_CLIENT_ID=<google-oauth-client-id>
GOOGLE_CLIENT_SECRET=<google-oauth-client-secret>

# Optional (with defaults)
BETTER_AUTH_URL=http://localhost:3000
NEXT_PUBLIC_APP_URL=http://localhost:3000
NODE_ENV=development
```

## Performance Considerations

### Database Optimization

1. **Indexes** (defined in [data-model.md](./data-model.md)):
   - `idx_user_email` on `user(email)` - Fast email lookup during sign-in
   - `idx_session_token` on `session(token)` - Fast session validation
   - `idx_session_user_id` on `session(userId)` - List user's sessions
   - `idx_account_provider_id` on `account(providerId, accountId)` - OAuth account lookup

2. **Connection Pooling**:
   - Neon serverless driver handles pooling automatically
   - Max connections: 10 (Neon free tier limit)

3. **Query Optimization**:
   - Use Kysely parameterized queries (Better Auth default)
   - Avoid N+1 queries (use joins where possible)
   - Enable experimental joins in Better Auth: `experimental: { joins: true }`

### Session Cache

**Cookie Cache Strategy**: `compact` (default)
- Cache duration: 5 minutes
- Reduces database hits for session validation
- Automatic invalidation on session changes

**Alternative**: `jwt` or `jwe` (encrypted)
- Use if need JWT compatibility or maximum security
- Trade-off: Larger cookie size, slower validation

### Rate Limiting

**Configuration**: 60 requests per minute per IP
- Storage: In-memory (Redis for production)
- Window: Sliding 60-second window
- Stricter limits for sign-in: 5 attempts per minute

### CDN and Caching

- **Static assets**: Vercel Edge Network
- **API responses**: No caching (authentication endpoints must always hit server)
- **Pages**: Next.js ISR for public pages, SSR for protected pages

## Monitoring & Observability

### Metrics to Track

1. **Authentication Metrics**:
   - Sign-up rate (per hour/day)
   - Sign-in success rate (target: >90%)
   - OAuth conversion rate (target: >80%)
   - Session creation rate
   - Sign-out rate

2. **Performance Metrics**:
   - API response time p50, p95, p99 (target: <500ms p95)
   - Database query time (target: <100ms)
   - OAuth callback duration (target: <2s)
   - Session validation time (target: <50ms)

3. **Security Metrics**:
   - Failed sign-in attempts (per user, per IP)
   - Rate limit violations
   - CSRF token validation failures
   - OAuth error rate
   - Suspicious activity alerts

4. **Error Metrics**:
   - Error rate by endpoint (target: <1%)
   - Database connection errors
   - OAuth provider errors
   - Session validation errors

### Monitoring Tools

1. **Vercel Analytics**: Built-in Next.js performance monitoring
2. **Sentry**: Error tracking and alerting
3. **Neon Console**: Database performance metrics
4. **Google Cloud Console**: OAuth usage metrics

### Logging Strategy

**Application Logs** (structured JSON):
```json
{
  "timestamp": "2025-01-13T10:00:00Z",
  "level": "info",
  "event": "user.sign_in",
  "user_id": "usr_123",
  "method": "email",
  "ip_address": "192.168.1.1",
  "user_agent": "Mozilla/5.0...",
  "success": true
}
```

**Security Logs** (separate, audit trail):
- All sign-in attempts (success + failure)
- All OAuth flows (initiation, completion, errors)
- All session creations, revocations
- All password reset requests
- All rate limit violations

**Never Log**:
- Passwords (even hashed)
- Session tokens
- OAuth access tokens or refresh tokens
- PII beyond email and name

### Alerting

**Critical Alerts** (immediate notification):
- Database connection failures
- OAuth provider downtime
- Error rate > 5%
- Authentication endpoint downtime

**Warning Alerts** (daily digest):
- High rate of failed sign-ins (possible brute-force attack)
- OAuth error rate > 10%
- Performance degradation (>1s p95 response time)
- Unusual traffic patterns

## Rollback Plan

### Deployment Rollback

1. **Vercel Deployment**:
   - Automatic rollback on error detection
   - Previous deployment remains accessible
   - Zero-downtime deployments (Vercel handles this)

2. **Database Migration Rollback**:
   - Use Neon branches to test migrations before production
   - Keep backup of pre-migration database state
   - Rollback SQL scripts prepared in advance
   - Point-in-time recovery available (Neon feature)

### Data Recovery

1. **Database Backups**:
   - Neon automatic backups (daily, 7-day retention)
   - Export to SQL before major migrations
   - Test restore procedure in staging

2. **Session Recovery**:
   - Sessions are transient, users can re-authenticate
   - No critical data loss if sessions are deleted
   - OAuth tokens can be refreshed by re-authenticating

### Disaster Recovery

**Scenario**: Complete database loss
1. Restore from most recent Neon backup (daily)
2. Recreate database schema using Better Auth CLI
3. Users must re-authenticate (sessions lost)
4. OAuth tokens refreshed on next sign-in

**RTO** (Recovery Time Objective): 1 hour
**RPO** (Recovery Point Objective): 24 hours (daily backup)

## Success Criteria Validation

| Success Criterion (from spec.md) | How to Measure | Target | Validation Method |
|----------------------------------|----------------|--------|-------------------|
| 95% sign-up completion under 2 minutes | Time from sign-up page load to dashboard redirect | ≥95% | Analytics tracking, funnel analysis |
| 90% first-attempt sign-in success | Successful sign-ins / total sign-in attempts | ≥90% | Database metrics, sign-in logs |
| 30% higher OAuth conversion rate | Google sign-in completions / Google sign-in initiations | +30% vs. baseline | OAuth flow analytics |
| 100% session persistence | Sessions active after 7 days / sessions created | 100% | Database session records, automated tests |
| Under 10 seconds OAuth flow | Time from Google button click to dashboard redirect | <10s p95 | Performance monitoring, automated tests |
| Zero critical security vulnerabilities | OWASP Top 10 vulnerabilities in production | 0 | Security audit, penetration testing |
| 100 concurrent sign-in requests | Load test with 100 concurrent users | No errors, <500ms p95 | Load testing (k6, Artillery) |
| 99.9% uptime | Downtime per month | <43 minutes/month | Uptime monitoring (Pingdom, UptimeRobot) |
| 60% reduction in support tickets | Authentication-related tickets / month | -60% vs. baseline | Support ticket analytics |
| 100% authentication logging | All auth events logged (sign-in, sign-out, OAuth) | 100% | Log analysis, audit trails |

## Next Steps

1. ✅ **Phase 0 Complete**: Research findings documented in `research.md`
2. ✅ **Phase 1 Complete**: Design artifacts created (`data-model.md`, `contracts/`, `quickstart.md`)
3. ✅ **Phase 2 Complete**: Implementation plan documented in this file
4. **Next Command**: Run `/sp.tasks` to generate detailed implementation tasks
5. **After Tasks**: Begin implementation following the phases outlined above

## References

- [Better Auth Documentation](https://www.better-auth.com)
- [Better Auth GitHub](https://github.com/better-auth/better-auth)
- [Neon PostgreSQL Documentation](https://neon.tech/docs)
- [Next.js 16 Documentation](https://nextjs.org/docs)
- [Google OAuth 2.0 Guide](https://developers.google.com/identity/protocols/oauth2)
- [Project Constitution](../../../.specify/memory/constitution.md)
- [Feature Specification](./spec.md)
- [Data Model](./data-model.md)
- [API Contract](./contracts/api-openapi.yaml)
- [Developer Quickstart](./quickstart.md)
